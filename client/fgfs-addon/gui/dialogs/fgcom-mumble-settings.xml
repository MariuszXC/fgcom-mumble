<?xml version="1.0"?>
<PropertyList>
    <name>fgcom-mumble-settings</name>
    <layout>vbox</layout>
    <width>600</width>

    <nasal>
        <open>
        <![CDATA[
            # (re-)open the missing radio dialog in case there are no COMs
            if (size(FGComMumble_radios.get_com_radios_usable()) == 0) {
                print("Addon FGCom-mumble WARNING: no usable COM radios where found! This should be reported to the aircraft devs (They need to include a <comm-radio> node in instrumentation.xml).");
                fgcommand("dialog-show", {"dialog-name" : "fgcom-mumble-comoverride"});
            }
        ]]>
        </open>
    </nasal>

    <group>
        <layout>hbox</layout>

        <text>
            <stretch>1</stretch>
            <halign>left</halign>
            <label>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</label>
            <format>FGCom-mumble (%s) settings</format>
            <property>/addons/by-id/org.hallinger.flightgear.FGCom-mumble/version</property>
        </text>

        <empty><stretch>1</stretch></empty>

        <button>
            <pref-width>20</pref-width>
            <pref-height>20</pref-height>
            <legend>?</legend>
            <binding>
                <command>open-browser</command>
                <path>https://wiki.flightgear.org/FGCom-mumble</path>
            </binding>
        </button>

        <button>
            <legend>X</legend>
            <key>Esc</key>
            <pref-width>20</pref-width>
            <pref-height>20</pref-height>
            <binding>
                <command>dialog-close</command>
            </binding>
        </button>

    </group>

    <hrule/>

    <text>
        <halign>left</halign>
        <label>Options for sending data to the FGCom-Mumble plugin:</label>
    </text>
    <group>
        <layout>hbox</layout>
        <halign>left</halign>
        <group>
            <layout>hbox</layout>
            
            <default-padding>10</default-padding>
            <empty><width>6</width><stretch>1</stretch></empty>
        </group>
        
        <group>
            <layout>vbox</layout>

            <checkbox>
                <halign>left</halign>
                <label>Enable sending data</label>
                <property>/addons/by-id/org.hallinger.flightgear.FGCom-mumble/enabled</property>
            </checkbox>

            <group>
                <layout>hbox</layout>

                <text>
                    <halign>left</halign>
                    <label>Send rate (Hz):</label>
                </text>

                <input>
                    <name>refresh-rate</name>
                    <height>25</height>
                    <halign>left</halign>
                    <property>/addons/by-id/org.hallinger.flightgear.FGCom-mumble/refresh-rate</property>
                </input>
            </group>

            <group>
                <layout>hbox</layout>

                <text>
                    <label>Host/Port:</label>
                    <halign>left</halign>
                </text>

                <input>
                    <height>25</height>
                    <halign>left</halign>
                    <property>/addons/by-id/org.hallinger.flightgear.FGCom-mumble/host</property>
                </input>
                <input>
                    <height>25</height>
                    <halign>left</halign>
                    <property>/addons/by-id/org.hallinger.flightgear.FGCom-mumble/port</property>
                </input>
            </group>
        
            
        </group>
    </group>
    
    <hrule/>

    <text>
        <halign>left</halign>
        <label>Options for plugin configuration:</label>
    </text>
    <group>
        <layout>hbox</layout>
        <halign>left</halign>
        <group>
            <layout>hbox</layout>
            
            <default-padding>10</default-padding>
            <empty><width>6</width><stretch>1</stretch></empty>
        </group>
        
        <group>
            <layout>vbox</layout>

            <checkbox>
                <halign>left</halign>
                <label>Enable audio effects (static noise, ...)</label>
                <property>/addons/by-id/org.hallinger.flightgear.FGCom-mumble/audio-effects-enabled</property>
            </checkbox>

            <checkbox>
                <halign>left</halign>
                <label>Enable hearing non-plugin Mumble users</label>
                <property>/addons/by-id/org.hallinger.flightgear.FGCom-mumble/audio-hear-all</property>
            </checkbox>
        </group>
    </group>
    
    <hrule/>
    
    <text>
        <halign>left</halign>
        <label>Miscellaneous:</label>
    </text>
    <group>
        <layout>hbox</layout>
        <halign>left</halign>
        <group>
            <layout>hbox</layout>
            
            <default-padding>10</default-padding>
            <empty><width>6</width><stretch>1</stretch></empty>
        </group>
        
        <group>
            <layout>vbox</layout>

            <checkbox>
                <halign>left</halign>
                <name>chbx_enable_echotest</name>
                <label>Enable Echotest</label>
                <live>true</live>
                <property>/addons/by-id/org.hallinger.flightgear.FGCom-mumble/force-echotest-frq</property>
                <binding>
                    <command>dialog-apply</command>
                    <object-name>chbx_enable_echotest</object-name>
                </binding>
            </checkbox>
            <button>
                <legend>Open COMBar</legend>
                <pref-width>180</pref-width>
                <pref-height>30</pref-height>
                <binding>
                    <command>nasal</command>
                    <script><![CDATA[
                        if (size(FGComMumble_radios.get_com_radios_usable()) > 0) {
                            FGComMumble_combar.combar.show();
                        } else {
                            # instead of the combar, show a message.
                            canvas.MessageBox.critical(
                                "FGCOM-mumble error",
                                "No usable radios where found!",
                                cb = nil,
                                buttons = canvas.MessageBox.Ok
                            );
                        }
                    ]]></script>
                </binding>
                <binding>
                    <command>dialog-close</command>
                </binding>
            </button>
        </group>
    </group>
    
    <hrule/>

    <group>
        <layout>hbox</layout>
        <empty><stretch>1</stretch></empty>
        <button>
            <legend>OK</legend>
            <pref-width>90</pref-width>
            <pref-height>30</pref-height>
            <binding>
                <command>dialog-apply</command>
            </binding>
            <binding>
                <command>dialog-close</command>
            </binding>
        </button>

        <button>
            <legend>Apply</legend>
            <pref-width>90</pref-width>
            <pref-height>30</pref-height>
            <binding>
                <command>dialog-apply</command>
            </binding>
        </button>

        <button>
            <legend>Cancel</legend>
            <pref-width>90</pref-width>
            <pref-height>30</pref-height>
            <binding>
                <command>dialog-close</command>
            </binding>
        </button>
        <empty><stretch>1</stretch></empty>
    </group>
</PropertyList>
